{"version":3,"file":"offers.min.js","sources":["../src/offers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handle the offers form adding and deleting cases.\n *\n * @module     enrol_wallet/offers\n * @copyright  2024 2024, Mohammad Farouk <phun.for.physics@gmail.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Ajax from 'core/ajax';\nimport $ from 'jquery';\n/**\n * @type {JQuery<HTMLElement>}\n */\nlet container;\nlet courseid;\nlet i = 0;\n\n/**\n * Add form fragment in the offers container.\n *\n * @param {string} type\n */\nfunction addFragment(type) {\n    let request = Ajax.call([{\n        methodname: \"enrol_wallet_get_offer_form_fragment\",\n        args: {\n            type: type,\n            increment: i,\n            course: courseid,\n        }\n    }]);\n    request[0].done((data) => {\n        container.append(data.data);\n        addDeleteButtonListener();\n    });\n}\n\n/**\n * Add listeners to delete buttons.\n */\nfunction addDeleteButtonListener() {\n    let buttons = $('[data-action=\"deleteoffer\"]');\n    buttons.off('click');\n    buttons.on('click', function(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        let number = $(this).data('action-delete');\n        let set = $('#offer_group_' + number);\n        set.remove();\n    });\n}\n\n/**\n * Add listener to select element to add new offers.\n */\nfunction addSelectListener() {\n    let select = $('select[name=\"add_offer\"]');\n    select.on('change', function() {\n        i++;\n        let selector = $(this);\n        addFragment(selector.val());\n        selector.val('');\n    });\n}\n\n/**\n * Init\n * @param {number} cid the course id\n * @param {number} inc the increment\n */\nexport const init = (cid, inc = 0) => {\n    i = inc;\n    courseid = cid;\n    container = $('#id_wallet_offerscontainer');\n\n    addDeleteButtonListener();\n    addSelectListener();\n};"],"names":["container","courseid","i","addDeleteButtonListener","buttons","off","on","event","preventDefault","stopPropagation","number","this","data","remove","addSelectListener","selector","type","val","Ajax","call","methodname","args","increment","course","done","append","cid","inc"],"mappings":";;;;;;;SA4BIA,UACAC,sKACAC,EAAI,WAyBCC,8BACDC,SAAU,mBAAE,+BAChBA,QAAQC,IAAI,SACZD,QAAQE,GAAG,SAAS,SAASC,OACzBA,MAAMC,iBACND,MAAME,sBACFC,QAAS,mBAAEC,MAAMC,KAAK,kBAChB,mBAAE,gBAAkBF,QAC1BG,qBAOHC,qBACQ,mBAAE,4BACRR,GAAG,UAAU,WAChBJ,QACIa,UAAW,mBAAEJ,UArCJK,KAAAA,KAsCDD,SAASE,MArCXC,cAAKC,KAAK,CAAC,CACrBC,WAAY,uCACZC,KAAM,CACFL,KAAMA,KACNM,UAAWpB,EACXqB,OAAQtB,aAGR,GAAGuB,MAAMZ,OACbZ,UAAUyB,OAAOb,KAAKA,MACtBT,6BA4BAY,SAASE,IAAI,qBASD,SAACS,SAAKC,2DAAM,EAC5BzB,EAAIyB,IACJ1B,SAAWyB,IACX1B,WAAY,mBAAE,8BAEdG,0BACAW"}